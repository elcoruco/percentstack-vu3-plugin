import{ref as e,computed as t,openBlock as a,createElementBlock as l,normalizeClass as o,normalizeStyle as r,unref as i,createCommentVNode as n,createElementVNode as s,Fragment as u,renderList as h}from"vue";import{scaleLinear as c}from"d3-scale";import"process";const v=s("h1",null,null,-1),g=["viewBox"],m=["transform"],d=["width","height","fill"],p=["width","height","fill","x","onMouseenter"],f=["transform"],x=["x"],b=["x"],w=["x"],y=["innerHTML"];var k={__name:"SimpleStackView",props:{width:Number,height:Number,background:String,data:Array,margin:Object,color:String,baseColor:String,axis:Object,tooltipFn:Function,hideTicks:Boolean,max:Number},setup(k){const $=k,M=1/6*400,C="#C6C6C6",S={position:"bottom",textClass:""},_={top:5,right:5,bottom:M/4,left:5},T=e(!1),E=e=>e.key?`${e.key} : ${e.value}`:`${e.value}`,j=e(""),A=e("0px"),O=e("0px"),B=e("white"),F=e(7),N=t((()=>$.width||400)),H=t((()=>$.height||M)),L=t((()=>$.hideTicks||false)),V=t((()=>$.background||"white")),X=t((()=>{let e;return"top"==$.axis?.position&&(_.bottom=5,_.top=M/4),$.hideTicks&&(_.top=5,_.bottom=5),e=$.margin?Object.assign({},_,$.margin):_,e}));t((()=>$.color||"orange"));const Y=t((()=>$.baseColor||"#ECECEC")),q=t((()=>$.axis?Object.assign(S,$.axis):S)),P=t((()=>$.tooltipFn||E)),z=t((()=>{try{return $.data.map((e=>e.value)).reduce(((e,t)=>e+t),0)}catch(e){throw $.data?Array.isArray()?new Error("Maybe the items of the data array have some problem"):new Error("The data property must be an Array"):new Error("The data property is required")}})),D=t((()=>({width:N.value-X.value.left-X.value.right,height:H.value-X.value.top-X.value.bottom}))),G=t((()=>{let e;return e=$.max?$.max:z.value>100?z.value:100,c().domain([0,e]).range([0,D.value.width])})),I=(e,t)=>{if(!t)return 0;let a=0;for(let l=0;l<t;l++)a+=G.value(e[l].value);return a},J=e=>{A.value=`${e.clientY+F.value}px`,O.value=`${e.clientX+F.value}px`},K=()=>{T.value=!1};const Q=function*(){for(;;){const e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),a=Math.floor(256*Math.random());yield`rgb(${e}, ${t}, ${a})`}}();return(e,t)=>(a(),l("div",{class:o("gf_simplestack_container")},[v,(a(),l("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg",style:r({background:i(V)}),version:"1.2",baseProfile:"tiny",width:"100%",height:"100%",viewBox:`0 0 ${i(N)} ${i(H)}`,"stroke-linecap":"round","stroke-linejoin":"round",class:o("gf_simplestack_svg")},[n(" bars "),s("g",{transform:`translate(${i(X).left}, ${i(X).top})`},[s("rect",{width:i(D).width,height:i(D).height,fill:i(Y)},null,8,d),(a(!0),l(u,null,h(k.data,((e,t)=>{return a(),l("rect",{width:i(G)(e.value),height:i(D).height,fill:(o=e,o.color||(o.color=Q.next().value),o.color),x:I(k.data,t),onMouseenter:t=>((e,t)=>{T.value=!0,j.value=P.value(t),A.value=`${e.clientY+F.value}px`,O.value=`${e.clientX+F.value}px`})(t,e),onMousemove:J,onMouseout:K,key:`bar-${t}`},null,40,p);var o})),128))],8,m),n(" xScaleAxis "),i(L)?n("v-if",!0):(a(),l("g",{key:0,transform:`translate(0, ${i(H)-i(X).bottom})`},[s("text",{class:o(i(q).textClass),fill:C,x:i(X).left,y:5,"alignment-baseline":"hanging","text-anchor":"start"},"0%",10,x),s("text",{class:o(i(q).textClass),fill:C,x:i(X).left+i(D).width/2,y:5,"alignment-baseline":"hanging","text-anchor":"middle"},"50%",10,b),s("text",{class:o(i(q).textClass),fill:C,x:i(X).left+i(D).width,y:5,"alignment-baseline":"hanging","text-anchor":"end"},"100%",10,w)],8,f))],14,g)),T.value?(a(),l("div",{key:0,class:"gf-tooltip",style:r({top:A.value,left:O.value,display:"block",position:"fixed",background:B.value}),innerHTML:j.value},null,12,y)):n("v-if",!0)],2))},__file:"src/SimpleStackView.vue"},$={install:(e,t)=>{e.component("gf-simple-stack",k)}};export{$ as default};
